-----
### fsync()를 이용한 즉시 기록
-----
1. write() 호출 목적은 대부분 해당 데이터를 가까운 미래에 영속 저장 장치에 기록해달라고 파일 시스템에게 요청
2. 성능상 이유로 파일 시스템은 일정 시간(예) 5초 또는 30초) 동안 메모리를 모음 (버퍼링(Buffering))
3. 일정 간격으로 쓰기 요청(들)이 저장 장치에 전달되며, 응용 프로그램 입장에서는 write() 호출 즉시 쓰기가 완료된 것처럼 보이지만, 드물게 (예) write()를 호출했지만 디스크에 쓰기 직전 기계가 크래시한 경우) 데이터가 유실되는 경우 발생
4. 강제적으로 즉시 디스크에 기록할 수 있는 기능으로, UNIX에서는 응옹 프로그램에게 제공되는 인터페이스는 fysnc(int fd)
   - 프로세스가 특정 파일 디스크럽터에 대해서 fsync()를 호출하면 파일 시스템은 지정된 파일의 모든 더티(Dirty, 즉 갱신된) 데이터를 디스크로 강제로 내려보냄
   - 모든 쓰기들이 처리되면 fsync() 루틴은 리턴

5. fsync()를 사용하는 방법에 관한 예제
   - 코드에서 foo라는 파일을 열어 데이터 하나를 쓰며, 그리고 나서 fsync()를 호출하여 해당 블럭을 즉시 디스크에 강제적으로 기록
   - fsync()가 리턴하면 응용 프로그램은 데이터가 영속성을 갖게 되었다는 것을 보장하게 다음으로 진행 가능
```c
1 int fd = open(“foo ”, O_CREAT | O_WRONLY | O_TRUNC);
2 assert(fd > −1);
3 int rc = write(fd , buffer , size);
4 assert(rc == size);
5 rc = fsync(fd);
6 assert(rc == 0);
```
   - 물론 완전히 보장해주지 못함
   - 어떤 경우 파일 foo가 존재하는 디렉토리도 fsync() 해줘야 하며, 디렉토리를 함께 fsync() 함으로써, 파일 자체와 이 파일이 존재하는 디렉토리 모두 안전하게 디스크에 저장하는 것이 보장
   - 파일이 새로이 생성된 경우, 디렉토리를 반드시 fsync() 해줘야함
