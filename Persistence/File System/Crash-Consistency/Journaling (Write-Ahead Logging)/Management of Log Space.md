-----
### 로그 공간의 관리
-----
1. 파일 시스템은 갱신의 내용을 메모리에 일정 시간 동안 버퍼에 유지
2. 갱신 내용을 디스크에 기록할 시점이 되면, 먼저 파일 시스템은 저널에 저널 트랝개션의 상세 내용을 씀(Wirte-Ahead Logging)
3. 트랜잭션이 완료되면 파일 시스템은 각 블럭들을 디스크 최종 위치에 체크포인트함
4. 로그의 크기는 정해져 있는데, 만약 트랜잭션이 계속 추가되면 얼마 지나지 않으면 공간이 소진될 것
<div align="center">
<img src="https://github.com/user-attachments/assets/601447f4-ee28-483f-8eb8-625fceb8d174">
</div>

5. 로그 공간이 가득찰 경우 문제 사항
   - 첫 번째 문제 : 로그에 있는 모든 트랜잭션을 (순서대로) 재실행해야하므로 로그가 커질수록 복구 소요 시간이 길어짐
   - 두 번째 문제 : 만약 로그가 가득차면(또는 거의 찼다면) 디스크에 더 이상 트랜잭션을 커밋할 수 없게 되므로, 파일 시스템을 갱신하는 모든 작업들이 실패하여 파일 시스템이 쓸모없게 됨
   - 이 문제를 해결하기 위해 저널링 파일 시스템은 로그를 환형 구조 형식으로 사용
     + 로그 영역을 끝까지 다 쓰면, 앞에서부터 다시 쓰기를 시작하며, 이와 같은 이유로 저널을 때로는 환형 로그(Circular Log)라고도 부름
     + 파일 시스템은 트랜잭션이 체크포인트되면 해당 로그 공간이 재사용될 수 있도록 트랜잭션이 차지하고 있던 공간을 비움
     + 이 기능은 다양한 방법으로 구현할 수 있음
     + 예를 들어, 최신 트랜잭션과 가장 오래된 트랜잭션 위치를 저널 슈퍼블럭에 기록해 놓음
     + 두 영역 사이의 블럭들은 의미 있는 로그 정보를 가지고 있으며, 그 외의 공간은 재사용 가능한 빈 공간이 됨
<div align="center">
<img src="https://github.com/user-attachments/assets/7e59f796-7f74-4106-b008-d3ef39f6939e">
</div>

   - 저널 슈퍼블럭(파일 시스템 슈퍼블럭과 혼동되서는 안 됨)은 체크포인트가 안 된 트랜잭션을 구분할 수 있을 만큼의 충분한 정보를 가짐
   - 이 정보를 통해 복구 시간을 단축시키고, 로그를 재사용
   - 기본 저널 알고리즘에 다음 과정 추가
     + 저널 쓰기 : 트랜잭션 내용을 로그에 쓰며(TxB와 갱신에 대한 내용 포함), 이 쓰기가 완료되기를 기다림
     + 저널 커밋 : 트랜잭션 커밋 블럭을 로그에 쓰며(TxE를 포함), 쓰기가 완료되기를 기다림 (이제 트랜잭션은 커밋된 상태)
     + 체크포인트 : 갱신에 대한 내용을 파일 시스템 내의 원래의 위치에 씀
     + 프리 : 일정 시간 이후 자널 슈퍼블럭을 갱신하여 저널의 트랜잭션 해제
    
   - 최종 데이터 저널링 프로토콜이지만, 문제가 존재
     + 크래시는 사실 별로 자주 일어나지 않으므로, 복구를 위해 모든 데이터 블럭을 디스크에 두 번씩 기록하는 것은 여러모로 너무 부담스러움
