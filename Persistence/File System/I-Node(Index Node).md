-----
### 파일 구성 : 아이노드
-----
1. 파일 시스템의 디스크 자료 구조 중 가장 중요한 것은 아이노드(I-Node)
2. 아이노드는 인덱스 노드(Index Node)의 줄임말로서, 역사적으로 UNIX 창시자인 Ken Thompson이 처음 사용
   - 이 노드들은 원래는 배열로 되어 있는데, 각 배열은 특정 아이노드를 접근하기 위해 탐색

3. 자료 구조 - 아이노드
   - 파일 메타데이터를 저장하기 위한 자료 구조로서 많은 파일 시스템들이 아이노드(I-Node)라는 일반적인 이름을 사용
   - 이 자료구조는 파일 크기, 접근 권한, 그리고 파일 블럭들의 위치 정보를 가지고 있음
   - 디스크 상 아이노드의 배열의 인덱스로 아이노드 번호를 사용하던 것에서 기안
   - D-Node, F-Node 등으로도 불림

4. 각 아이노드는 숫자(아이넘버(I-Number))로 표현되며, 파일의 저수준 이름(Low-Level Name)이라고도 불림
   - VSFS에서는 아이넘버를 사용해서 해당 아이노드가 디스크 상 어디에 있는지 직접 ㄱ쎼ㅏㄴ 가능
   - 예시
<div align="center">
<img src="https://github.com/user-attachments/assets/c37620ab-12ba-4787-8bb7-4ec0def6e48a">
</div>

   - 크기가 20KB이고(4KB 블럭 5개), 80개의 아이노드(각 아이노드는 256Bytes)로 이루어져있음 (슈퍼블럭은 0KB에 위치에서 시작)
   - 아이노드 비트맵 주소는 4KB에서부터, 데이터 비트맵은 8KB에서부터 시작하며, 아이노드 테이블은 그 바로 직후에 있음
   - VSFS 파일 시스템 파티션의 시작 부분은 다음과 같음
<div align="center">
<img src="https://github.com/user-attachments/assets/c37620ab-12ba-4787-8bb7-4ec0def6e48a">
</div>>

5. 32번 아이노드를 읽기 위해 파일 시스템은 아이노드 영역에서의 오프셋 계산 : 32 * sizeof(inode) 또는 8192)
   - 그 후, 아이노드 테이블의 시작 위치를 더하면(inodeStartAddr = 12KB), 원하는 아이노드 블럭의 정확한 바이트 주소를 구할 수 있음(20KB)
   - 💡 디스크는 바이트 단위로는 접근이 불가능하여 대신에 대체적으로 512 바이트 크기를 갖는 섹터(Sector)로 이루어짐
   - 32번 아이노드가 존재하는 블럭을 가져오기 위해서는 파일 시스템은 섹터 주소 $\frac {20 × 1024}{512}$ 또는 40에 대한 읽기 요청을 해당 아이노듭 ㅡㄹ럭을 가져옴
   - 아이노드 블럭의 섹터 주소 iaddr은 다음과 같이 계산 가능
```c
blk = (inumber * sizeof(inode_t)) / blockSize;
sector = ((blk * blockSize) + inodeStartAddr) / sectorSize;
```

6. 아이노드에는 파일에 대한 정보가 다 들어있으며, 파일의 종류(예) 일반 파일, 디렉터리 등), 크기, 할당된 블럭 수, 보호 정보(파일의 소유, 접근 권한 등), 시간 정보와 더불어 데이터 블럭이 디스크 어디에 존재하는지 (예) 포인터의 일종)와 같은 정보들이 담겨 있음
   - 이와 같은 파일에 대한 정보들을 메타데이터(Metadata)라고 하며, 사용자 데이터가 아닌 기타 정보를 통틀어 메타데이터라 부름
   - EXT2의 아이노드 예
<div align="center">
<img src="https://github.com/user-attachments/assets/97728369-9e0f-46ac-adf7-6fbb751d4d4d">
</div>

7. 아이노드 설계 시 가장 중요한 결정 중 하나는 데이터 블럭의 위치를 표현하는 방법
   - 간단한 방법은 아이노드 내 여러 개의 직접 포인터(Direct Pointer, 디스크 주소)를 두는 것
   - 각 포인터는 파일의 디스크 블럭 하나를 가리킴
   - 이 방법은 제약이 많음 : 파일 크기의 제한이 있으며, 파일 크기가 (포인터의 개수) * (블럭 크기)로 제한
