-----
### FFS에 대한 기타 사항
-----
1. FFS는 혁신적인 기법을 개발하여 적용
2. 특히 작은 파일들을 효율적으로 저장하기 위해 많은 노력을 함
   - 그 당시에는 2KB 크기의 파일들이 많았는데, 4KB를 사용하였기 때문에 데이터를 전송하는 것에는 이득이 없었지만 공간 활용면에서는 비효율적
   - 일반 파일 시스템에서는 내부 단편화로 인해 대략 반 정도의 공간이 낭비

3. FFS 설계자들은 이 문제를 간단하게 해결
   - 파일 시스템이 파일을 할당할 수 있도록 512 Byte의 서브블록(Sub-Block) 개념을 도입
   - 작은 파일(1KB 크기)을 생성할 때, 두 개의 서브블럭을 할당함으로써 4KB 블럭 전체가 낭비되는 경우가 발생하지 않도록 함
   - 파일이 커지면, 파일 시스템은 4KB가 될 때까지 512 Byte 크기의 블럭을 추가로 할당
   - 서브블럭들의 합이 4KB 되는 시점에 FFS는 4KB 블럭을 찾아 서브블럭들을 복사해 넣은 후 해당 서브블럭들을 다시 사용할 수 있도록 해제

4. 파일 시스템의 추가 동작이 많이 발생하므로, 이 과정이 비효율적이라고 생각할 수 있음
   - 정확히는 많은 I/O가 복사 때문에 발생하는데, FFS는 이러한 경우를 피하기 위해 libc 라이브러리를 수정
   - 라이브러리는 쓰기 요청을 버퍼에 두었다가 4KB 청크가 되면 파일 시스템에 내리는 식으로 대부분의 서브블럭을 사용하는 특수한 경우를 완전히 제거할 수 있도록 함

5. FFS에서 개발된 또 하나의 기발한 아이디어는 성능에 최적화된 디스크 배치
   - SCSI 또는 좀 더 근대화된 장치 인터페이스 이전 디스크는 정교하지 않았으며, 호스트 CPU가 장치의 동작을 직접 제어하였음
   - 따라서, 그림의 왼편과 같이 디스크를 연속적 섹터들에 파일을 저장해야 할 때 문제가 발생
<div align="center">
<img src="https://github.com/user-attachments/assets/6506f250-ba45-499b-9018-75b71bd88d1f">
</div>

   - 순차 읽기 시 문제가 발생하며, FFS가 먼저 블럭 0번에 대한 읽기를 요청하고 그 요청이 끝나면 다음 블럭, 즉 블럭 1에 대한 읽기를 요청함
   - 블럭 1은 헤드를 지나갔으므로, 1번 블럭을 읽기 위해서는 한 바퀴를 다 돌아야 함
   - FFS는 이 문제를 해결하기 위해 오른쪽과 같이 디스크 배치를 바꾸는 식으로 해결 : 하나 건너에 블럭을 배치하여 FFS는 다음 요청에 대한 블럭이 헤드 아래로 지나가기 전에 해당 블럭을 요청할 충분한 시간을 벌 수 있었음
   - 사실 FFS는 추가 회전을 피하기 위해 특정 디스크 몇 개의 블럭을 건너뛰어서 배치할지 알 만큼 영리함
   - FFS는 디스크의 특정 성능 매개변수들을 검출해낸 후, 그 정보를 정확한 시차에 따라 배치 기법을 결정할 수 있도록 하는데, 이 기법을 매개화(Parameterization)

6. 이러한 배치 기법을 사용하면 최대 대역폭의 50%밖에 얻을 수 없음
   - 각 블럭을 한 번씩 읽기 위해 같은 트랙을 두 바퀴 돌기 때문임
   - 하지만, 현대 디스크들은 내부적으로 한 트랙을 모두 내부 디스크 캐시에 버퍼링(트랙 버퍼라고 함)
   - 해당 트랙에 연달아 읽기 요청이 들어오면 디스크는 캐시에서 원하는 값을 리턴하며, 파일 시스템은 그러므로 더 이상 하위수준에 상세 부분에 대해서 신경쓰지 않아도됨
  
7. 사용자의 편의성을 개선하기 위한 기능 추가
   - FFS는 긴 파일 이름 지원하는 최초 파일 시스템 중 하나 (전통적인 고정 길이 방식(예) 8글자) 대신에 좀 더 표현력 있는 이름 사용 가능)
   - 심볼릭 링크 개념을 도입한 최초 파일 시스템
     + 하드 링크는 디렉토리를 가리킬 수 없으며 (파일 시스템 순환 구조를 만들 수 있는 우려 상황 때문에), 같은 볼륨 내 파일들만 가리킬 수 있다는(즉, 아이노드 번호가 의미를 갖는 공간) 제약이 존재
     + 심볼릭 링크는 사용자가 시스템 내 파일 또는 디렉토리에 상관없이 가명(Alias)를 만들 수 있도록 허용하므로 더 융통성 존재
   - FFS는 파일의 이름을 원자적으로 변경하는 rename() 명령도 소개
   - 기본적 기술 이외에도 사용성을 개선한 기법들로 인해 인기를 얻음
