-----
### 디렉토리 관리 방법
-----
1. 파일을 접근하기 위해서는 디렉터리들을 읽어야 하는데, LFS에서 디렉터리 데이터를 저장하는 방법
2. 디렉터리 자료 구조도 전통적인 UNIX 파일 시스템과 기본적으로 동일
   - 디렉토리는 매핑 정보(이름과 아이노드 번호)로 구성
   - 파일을 생성할 때 LFS는 새로운 아이노드와 데이터 그리고 파일을 가리키는 디렉터리 데이터와 아이노드도 같이 써야함
   - LFS는 이 정보들을 디스크에 순차적으로 기록 (일정 시간 동안 갱신 내용을 버퍼에 보관 후)
   - foo라는 파일을 디렉토리에 생성하기 위해 다음과 같은 자료 구조를 디스크에 추가 기록
<div align="center">
<img src="https://github.com/user-attachments/assets/90ac9d97-677b-47d9-a6bc-9f82bf43faf8">
</div>

3. 아이노드 맵 블럭은 디렉토리 파일 dir과 생성된 파일 foo의 아이노드 위치를 가지고 있음
   - dir 디렉토리에 존재하는 foo 파일을 읽는 과정
   - 먼저 아이노드 맵에서(대부분 메모리에 캐시됨) 디렉토리 dir의 아이노드 위치를 파악 (a3)
   - 그 후 디렉터리 데이터(A2)의 위치를 얻기 위해 디렉토리 dir의 아이노드를 읽음
   - 디렉터리의 데이터 블럭에서 (foo, k)의 파일명과 파일의 아이노드 번호 매핑 정보를 파악
   - 아이노드 번호 k (A1)의 아이노드 위치를 찾기 위해 아이노드 맵을 다시 조회
   - 최종적으로 주소 A0에 있는 데이터 블럭을 읽음

4. 아이노드 맵은 재귀 갱신 문제(Recursive Update Problem)이라는 LFS가 존재하는 심각한 문제 해결
   - 이 문제는 원래 위치에 덮어쓰기를 하지 않고, 갱신 내용을 디스크의 새로운 위치에 갱신하는 파일 시스템(LFS와 같은)에는 모두 존재

5. 아이노드가 갱신되면 디스크 상 아이노드 위치가 바뀜
   - 만약 디렉토리 항목들이 아이노드 위치를 직접 가리키도록 설계되었다면, 아이노드 위치가 변경되면 디렉토리의 데이터 블럭도 갱신되어야 함
   - 이런 메커니즘 하에서는 디렉토리의 부모 디렉터리도 갱신해야 하고, 또 그 위도 갱신하여 루트까지 갱신하여야 함
   - LFS에서는 이 문제를 imap을 사용하여 해결 : 아이노드 위치가 변경되더라도 변경 내용은 디렉터리 내에 직접 반영되지 않으며, 디렉토리에는 동일한 이름-아이노드 번호 매핑을 유지하면서 imap 자료 구조를 갱신
   - 이렇게 LFS는 간접 참조를 활용해 재귀 갱신 문제 해결
