-----
### 블럭의 최신 여부 판단
-----
1. 세그먼트 S에 존재하는 데이터 블럭 D에 대해서, LFS는 D가 최신인지 판단할 수 있어야 함
   - 이를 위해 각 블럭에 대한 설명 정보를 세그먼트에 추가
   - LFS는 각 데이터 블럭 D에 대해 D가 속한 파일의 아이노드 번호(어떤 파일에 속하는지)와 파일 내에서 오프셋(해당 파일에 몇 번째 블럭인지) 저장
   - 이 정보는 세그먼트 첫 머리에 세그먼트 요약 블럭(Segment Summary Block)이라 부르는 자료 구조에 기록

2. 이 정보를 활용하면 각 블럭의 유효성 여부 파악 가능
   - 디스크 주소 A에 위치한 블럭 D의 유효성 여부를 판단하는 과정
   - 세그먼트 요약 블럭에서 블럭 D의 아이노드 번호 N과 오프셋 T를 파악
   - 그 다음 imap에서 아이노드 N의 위치를 찾고, 디스크에서 그 N을 읽음
   - 마지막으로 아이노드(또는 어떠한 간접 블럭)를 이용하여 오프셋 T에 해당하는 블럭의 디스크 위치를 알아냄
   - 파악된 위치가 주소 A와 일치하면 블럭 D는 유효한 블럭이며, 파악된 위치가 D의 위치와 다르면 D는 유효하지 않음
   - 의사 코드
```c
(N, T) = SegmentSummary[A];

inode = Read(imap[N]);

if (inode[T] == A)
    // 블럭 D는 유효함
else
    // 블럭 D는 Garbage
```

3. 동작 원리를 그림으로 표현
<div align="center">
<img src="https://github.com/user-attachments/assets/cbd4576c-91c5-455b-8103-88ff1832fe94">
</div>

   - 주소 A0에 데이터 블럭이 위치
   - 세그먼트 요약정보에서 다음과 같은 사항을 얻을 수 있음
     + 데이터 블럭은 파일 k에 속함
     + 해당 데이터 블럭은 파일 내에서 오프셋 0의 위치에 존재
     + 세그먼트에 존재하는 imap에서 아이노드 k의 위치를 파악할 수 있음

4. 복잡하기도 하며, 성능에 문제가 발생 할 수 있음
5. 따라서, 좀 더 빠른 유효성 판단 기법들이 존재
   - 예를 들어, 파일을 truncate하거나 삭제됐을 때, LFS는 버전 번호(Version Number)를 증가시키고 그 새로운 버전 번호를 imap에 기록
   - 버전 번호를 디스크 상 세그먼트에 같이 기록해두고 LFS는 디스크 상 버전 번호와 imap의 버전 번호를 비교
   - 그 결과 추가적인 읽기도 방지 가능
