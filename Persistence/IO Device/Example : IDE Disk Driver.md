-----
### IDE 디스크 드라이버
-----
1. 실제 장치인 IDE 디스크 드라이브
   - IDE 디스크 시스템은 4개의 레지스터로 이루어진 단순한 인터페이스 제공 : Control, Command Block, Status, Error
   - 이 레지스터들은 (x86의) in, out I/O 명령어를 사용하여 특정 I/O 주소들을 읽거나 씀으로써 접근 가능 (아래 0x3F6)
<div align="center">
<img src="https://github.com/user-attachments/assets/273be943-efa8-4375-8752-5b3533f9b302">
</div>

2. 장치와 상호작용하기 위한 기본 방식 (장치는 이미 초기화되었다고 가정)
   - 장치가 준비될 때까지 대기 : 드라이브가 사용 중이지 않고 READY 상태가 될 때까지 Status 레지스터(0x1F7)를 읽음
   - Command 레지스터에 인자 값 쓰기 : 섹터의 수와 접근해야 할 섹터들의 논리 블럭 주소 (LBA), 그리고 드라이브 번호(IDE는 두 개의 드라이브만 지원, 마스터 = 0x00 또는 슬레이브 = 0x10)를 Command 레지스터(0x1F2 ~ 0x1F6)에 기록
   - I/O 시작 : Command 레지스터에 읽기 / 쓰기를 전달하며, READ / WRITE 명령어를 Command 레지스터에 기록 (0x1F7)
   - (쓰기의 경우) 데이터 전송 : 드라이브 상태가 READY이고 DRQ(Drive Request for Data, 데이터를 위한 드라이브 요청)일 때까지 기다리며, 데이터 포트에 데이터를 기록
   - 인터럽트 처리 : 가장 간단하게는 각 섹터가 전송되었을 때마다 인터럽트를 처리하게 하며, 좀 더 복잡한 방법은 일괄처리가 가능하도록 만들어 모든 전송이 완료되었을 때 최종적으로 한 번만 인터럽트를 발생시키도록 함
   - 에러 처리 : 각 동작 이후 Status 레지스터를 읽으며, 만약 ERROR 비트가 설정되어 있다면, ERROR 레지스터를 읽어 상세 정보 확인

3. 대부분 프로토콜은 xv6 IDE 드라이버에 나타나 있음
<div align="center">
<img src="https://github.com/user-attachments/assets/baa3042e-6ff8-4756-9a56-95d6da8bf29a">
</div>

   - 네 개의 기본 함수를 통하여 동작
   - ide_rw() : (대기 중인 다른 요청들이 있다면) 요청을 큐에 삽입하거나 (ide_start_request()를 통해) 디스크에 직접 명령
     + 어느 경우건 요청이 처리 완료되기를 기다리며 호출한 프로세스는 재움
   - ide_start_request() :  요청(쓰기의 경우에는 데이터도 함께)을 디스크로 내려보냄
     + x86의 in과 out 명령어가 장치 레지스터를 읽거나 쓰는데 각각 사용
   - ide_wait_ready() : 시작 요청 루틴은 이 함수를 사용하여 요청을 명령하기 전 드라이브가 준비되었는지 확인
   - ide_intr() : 인터럽트가 발생했을 때 호출하며, 장치에서 데이터를 읽고(쓰기가 아닌 읽기 요청의 경우) I/O가 종료되기를 기다리는 프로세스를 깨우며, (더 많은 요청이 I/O 큐에 있다면) ide_start_request()를 이용해 다음 요청 처리 시작
