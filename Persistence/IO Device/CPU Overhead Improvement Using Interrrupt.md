-----
### 인터럽트를 이용한 CPU 오버헤드 개선
-----
1. 장치와의 상호 작용을 개선하기 위해 인터럽트를 개발
   - 디바이스를 폴링하는 대신 운영체제는 입출력 작업을 요청한 프로세스를 블록시키고 CPU를 다른 프로세스에게 양도
   - 장치가 작업을 끝마치고 나면 하드웨어 인터럽트를 발생시키고 CPU는 운영체제가 미리 정의해놓은 인터럽트 서비스 루틴(Interrupt Service Routine(ISR)) 또는 간단하게 인터럽트 핸들러(Interrupt Handler)를 실행
   - 이 핸들러는 운영체제 코드의 일부이며, 인터럽트 핸들러는 입출력 요청의 완료(예) 데이터와 장치가 전달하는 에러 코드를 읽는 것 등), I/O를 대기 중인 프로세스 꺠우기 등 담당
   - 즉, 깨어난 프로세스가 작업을 계속 할 수 있도록 함

2. 사용률을 높이기 위한 핵심 방법 중 하나는 인터럽트를 활용해 CPU 연산과 I/O를 중첩
<div align="center">
<img src="https://github.com/user-attachments/assets/c743979f-79cb-46de-a021-4462a0632d2d">
</div>

   - CPU에서 프로세스 1이 일정시간 동안 실행되다가(CPU 줄에 반복된 1로 표현) 디스크의 데이터를 읽기 위해 I/O 요청을 발생
   - 인터럽트가 없다면 시스템은 I/O가 완료될 때까지 반복적으로 장치를 폴링(p로 표현)
   - 디스크 요청 처리가 완료되면 다시 프로세스 1이 동작할 수 있음

3. 프로세스 1의 요청이 디스크에서 처리되는 동안 운영체제가 프로세스 2를 CPU에서 실행
<div align="center">
<img src="https://github.com/user-attachments/assets/ad1bd1e0-f31b-4116-9516-ce75487787c0">
</div>

   - 디스크 요청이 완료되어 인터럽트가 발생하면 운영체제가 프로세스 1을 깨워 다시 실행
   - 그러므로 CPU와 디스크 시간 흐름표 중간 부분이 적절히 활용

4. 하지만, 인터럽트가 항상 최적의 해법은 아님
   - 예를 들어, 대부분 작업이 한 번의 폴링만으로 끝날 정도로 매우 빠른 장치라고 하면, 인터럽트를 사용하면 시스템이 느려지게 됨
   - 다른 프로세스로 문맥을 교환하고 인터럽트를 처리한 후 다시 I/O를 요청한 프로세스로 문맥 교환하는 것은 매우 비싼 작업
   - 그러므로 빠른 장치라면 폴링이 최선이며, 느리다면 인터럽트를 사용하여 중첩시키는 것이 최선

5. 만약 장치의 속도를 모른다거나 빠를 때도 있고, 느릴 때도 있는 장치라고 한다면, 짧은 시간 동안만 폴링을 하다가 처리가 완료되지 않으면 인터럽트를 사용하는 하이브리드 방식을 채용하는 것이 최선 : 즉, 두 단계 접근법으로 양쪽의 장점을 취할 수 있음
6. 네트워크 환경에서는 인터럽트를 사용하지 않음
   - 대량으로 도착하는 패킷이 있을 때 각 패킷마다 인터럽트가 발생하는데, 이 경우 인터럽트만 처리하다가 운영체제가 사용자 프로세스의 요청을 처리할 수 없도록 만드는 무한반복(Livelock)에 빠질 가능성이 있음
   - 예를 들어, 슬래시닷(Slashdot) 현상으로 인해 일시적으로 웹 서버에 사용자가 많이 몰리는 경우가 발생한다고 하면, 폴링을 사용하면 시스템의 상황을 보다 효율적 제어 가능
   - 웹 서버가 패킷 도착을 검사하기 전 사용자 요청들을 좀 더 처리할 수 있기 때문임

7. 또 다른 인터럽트 기반 최적화 기법은 병합(Coalescing)
   - CPU에 인터럽트를 전달하기 전 잠시 기다렸다가 인터럽트를 발생시킴
   - 기다리는 동안에 다른 요청들도 끝나게 되기 떄문에 여러 번 인터럽트르 발생시키는 대신 인터럽트를 한 번만 CPU에 전달
   - 이 방법으로 인터럽트 처리의 오버헤드를 줄일 수 있음
   - 물론, 너무 오래 기다리면 요청에 대한 지연 시간이 늘어나므로 시스템의 절충 시간을 찾아야함

8. 참고 : 인터럽트가 PIO보다 항상 좋은 것은 아님
   - 인터럽트를 사용하면 연산과 I/O 작업을 중첩시킬 수 있지만, 느린 장치에 대해서만 타당한 접근법
   - 그 외의 경우에는 인터럽트 처리와 문맥 교환 비용이 인터럽트가 제공하는 장점을 넘어서게 됨
   - 너무 많은 인터럽트로 인해 시스템이 멈춘 것 처럼 보일 수 있으므로, 운영체제가 원하는대로 스케줄링 할 수 있게 하는 폴링이 유용
